<html>
  <body>
    <iframe
      id="embedIFrame"
      width="100%"
      height="100%"
      src="https://www.youtube.com/embed/RJa4kG1N3d0?rel=0&enablejsapi=1&controls=0&autoplay=1&disablekb=1&fs=0&modestbranding=1&showinfo=0&autohide=1"
      allow="autoplay; encrypted-media"
      frameborder="0"
      allowfullscreen
    ></iframe>

    <script>
      // HANDLE NAV CHANGE
      ///////////////////////////
      // Send location changes to RN
      // window.addEventListener('locationchange', function(){
      //   const newURL = window.location.href;
      //   //window.ReactNativeWebView.postMessage(JSON.stringify({ type: 'URL_CHANGE', payload: newURL }));
      //   window.ReactNativeWebView.postMessage(newURL);
      //   console.log(
      //     'Message sent to RN: ',
      //     JSON.stringify({type: 'VIDEO', payload: videoURL}),
      //   );
      // });

      // history.pushState = ( f => function pushState(){
      //   var ret = f.apply(this, arguments);
      //   window.dispatchEvent(new Event('pushState'));
      //   window.dispatchEvent(new Event('locationchange'));
      //   return ret;
      // })(history.pushState);

      // history.replaceState = ( f => function replaceState(){
      //     var ret = f.apply(this, arguments);
      //     window.dispatchEvent(new Event('replaceState'));
      //     window.dispatchEvent(new Event('locationchange'));
      //     return ret;
      // })(history.replaceState);

      // window.addEventListener('popstate',()=>{
      //     window.dispatchEvent(new Event('locationchange'));
      // });
      /////////////////////////////

      console.log(
        'Message sent to RN: ',
        JSON.stringify({type: 'VIDEO', payload: videoURL}),
      );
      // Grab video handle
      const video = window.document.getElementsByTagName('video')[0];

      // Handle message FROM React-Native
      window.addEventListener('message', function(message) {
        try {
          console.log('Message recieved from RN: ', message);
          switch (message.data) {
            case 'PLAY':
              video.play();
              break;
            case 'PAUSE':
              video.pause();
              break;
            default:
              break;
          }
        } catch (e) {
          // dispatch('ERROR', e.message);
          console.log(e.message);
        }
        return true;
      });
    </script>
  </body>
</html>
